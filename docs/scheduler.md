# Scheduler operation

The scheduler is responsible for calculating the timings of cruise events. These events include:

1. departure from origin port
2. arrival at each stopover (accounting for passage times)
3. duration of stopover
4. departure time
5. arrival at destination 

The schedule is invoked everytime a cruise plan is filed. The associated ``Cruise Map`` (a  KML file for viewing in 
Google Earth) and ``Cruise Schedule`` are generated at the same time. 

# Warnings

The scheduler may generate warnings if it finds conflicts in the schedule. These warning include:

* Schedule warnings
* Navigational warnings
* Weather warnings

The warnings are included in the KML output files (as notes attached to  Leg and Stopover features) as well as in 
the detailed cruise schedule (output as markdown, HTML, PDF or plain text). The cruise planner should adjust the cruise
plan to minimise the number of warnings generated by the scheduler.

## Schedule warnings
These warning relate to conflicts in the scedule and are generated where a fixed commitment (recorded in the cruise plan) 
cannot be met.

1. Vessel arrives LATE in port (i.e. AFTER planned departure on next cruise)
2. Vessel arrives EARLY  in port (i.e. more than 7* days BEFORE planned departure on next cruise)
3. Vessel arrives EARLY  in port (causing STAY period and next departure to be inconsistent)
4. Vessel not in port for planned Crew pickup/setdown (vessel is LATE or has departed EARLY)
5. Vessel not in location for planned activity (feature not yet supported by CDL grammar)

When editing a cruise plan, the planner will attempt to eliminate all Schedule Warnings before publishing the plan.

## Navigation Warnings
These warning relate to navigation hazards

1. Leg includes one or more night passages
2. Nighttime arrival at stopover 
3. Nighttime departure from stopover
4. Low tide arrival at anchorage

## Weather Warnings

If a reliable data source is available, We hope to add a ``weather enroute`` feature that would provide 
a wind and wave prediction for hourly (or 3-hourly) intervals
along the intended cruise route. If this feature is added it would permit the following warning to be generate

1. Winds (speed and direction) in excess of <some limit> knots expected at <location> around <time>
2. Waves (hight/direction/period) in excess of <some limit> expected at <location> around <time>

The ``weather enroute`` predictions (and hence the associated warnings) would only be available for a period up to 
about 7 days ahead of the current time.  
